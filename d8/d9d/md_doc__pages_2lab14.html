<!-- HTML header for doxygen 1.9.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Microprocessor 2 Labs: Lab 14 ADC with LCD</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../microprocessor_2_template.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../university_of_texas_at_el_paso_logo-2.png"/></td>
  <td id="projectalign">
   <div id="projectname">Microprocessor 2 Labs<span id="projectnumber">&#160;v2.0</span>
   </div>
   <div id="projectbrief">Microprocessor 2 Lab Documenation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<head>
  <html> 
  <head>
      <!-- ... other metadata & script includes ... -->
      <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
      <script type="text/javascript">
          DoxygenAwesomeDarkModeToggle.init()
      </script>
  </head>
  <body>
<html>
  <head>
      <!-- ... other metadata & script includes ... -->
      <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
      <script type="text/javascript">
          DoxygenAwesomeFragmentCopyButton.init()
      </script>
  </head>
  <body>
<html>
    <head>
      <a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template" class="github-corner" title="View source on GitHub" target="_blank">
        <svg viewBox="0 0 250 250" width="50" height="50" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    </head>
    <body>
  <!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d8/d9d/md_doc__pages_2lab14.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Lab 14 ADC with LCD</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md142"></a> </p>
<h1><a class="anchor" id="autotoc_md143"></a>
Objective:</h1>
<ul>
<li>The objective of this lab is to utilize the <code>ADC peripheral</code> alongside the <code>LCD driver</code> to create a <code>digital multimeter (DMM)</code>. The LCD driver was provided by the main author of this documentation, <a href="https://github.com/jminjares4"><code>Jesus Minjares</code></a>, the driver can be found here: <a href="https://github.com/jminjares4/ESP32-LCD-1602-Driver"><code>LCD Driver</code></a>. </li>
</ul>
<h1><a class="anchor" id="autotoc_md144"></a>
Bonus</h1>
<ul>
<li><em><b>Undergrad Bonus:</b></em><ul>
<li>Use the digital multimeter to read a simple voltage-divider circuit.</li>
</ul>
</li>
<li><em><b>Grad Bonus:</b></em><ul>
<li>Using the ADC readings control the <code>sweeper function</code> from previous labs. Use up to 6 LEDs to demonstrate it. When the ADC reads the lowest value the LSB LED must turn on and when the ADC reads the highest value the MSB LED must turn on.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md145"></a>
ESP32 Pinout</h1>
<div class="fragment"><div class="line">                                        +-----------------------+</div>
<div class="line">                                        | O      | USB |      O |</div>
<div class="line">                                        |        -------        |</div>
<div class="line">                                    3V3 | [ ]               [ ] | VIN</div>
<div class="line">                                    GND | [ ]               [ ] | GND</div>
<div class="line">    Touch3 / HSPI_CS0 / ADC2_3 / GPIO15 | [ ]               [ ] | GPIO13 / ADC2_4 / HSPI_ID / Touch4</div>
<div class="line">CS / Touch2 / HSPI_WP / ADC2_2 /  GPIO2 | [ ]               [ ] | GPIO12 / ADC2_5 / HSPI_Q / Touch5</div>
<div class="line">     Touch0 / HSPI_HD / ADC2_0 /  GPIO4 | [ ]               [ ] | GPIO14 / ADC2_6 / HSPI_CLK / Touch6</div>
<div class="line">                        U2_RXD / GPIO16 | [ ]               [ ] | GPIO27 / ADC2_7 / Touch7</div>
<div class="line">                        U2_TXD / GPIO17 | [ ]               [ ] | GPIO26 / ADC2_9 / DAC2</div>
<div class="line">                     V_SPI_CS0 /  GPIO5 | [ ]  ___________  [ ] | GPIO25 / ADC2_8 / DAC1</div>
<div class="line">               SCK / V_SPI_CLK / GPIO18 | [ ] |           | [ ] | GPIO33 / ADC1_5 / Touch8 / XTAL32</div>
<div class="line">       U0_CTS / MSIO / V_SPI_Q / GPIO19 | [ ] |           | [ ] | GPIO32 / ADC1_4 / Touch9 / XTAL32</div>
<div class="line">                SDA / V_SPI_HD / GPIO21 | [ ] |           | [ ] | GPIO35 / ADC1_7 </div>
<div class="line">                 CLK2 / U0_RXD /  GPIO3 | [ ] |           | [ ] | GPIO34 / ADC1_6 </div>
<div class="line">                 CLK3 / U0_TXD /  GPIO1 | [ ] |           | [ ] | GPIO39 / ADC1_3 / SensVN </div>
<div class="line">       SCL / U0_RTS / V_SPI_WP / GPIO22 | [ ] |           | [ ] | GPIO36 / ADC1_0 / SensVP </div>
<div class="line">               MOSI / V_SPI_WP / GPIO23 | [ ] |___________| [ ] | EN </div>
<div class="line">                                        |                       |</div>
<div class="line">                                        |  |  |  ____  ____  |  |</div>
<div class="line">                                        |  |  |  |  |  |  |  |  |</div>
<div class="line">                                        |  |__|__|  |__|  |__|  |</div>
<div class="line">                                        | O                   O |</div>
<div class="line">                                        +-----------------------+</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md146"></a>
LCD Example Code</h1>
<p>This is an example code that demostrates how to utilize the LCD driver. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;driver/esp_lcd.h&quot;</span></div>
<div class="line"><span class="comment">/* LCD task */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#a8d74856407edcce26b3d62d33a38c630">lcd_task</a>(<span class="keywordtype">void</span> *pvParameters){</div>
<div class="line">    <span class="comment">/* Create LCD object */</span></div>
<div class="line">    <a class="code hl_struct" href="../../df/db0/structlcd__t.html">lcd_t</a> lcd;</div>
<div class="line">    <span class="comment">/* Set LCD to default pins */</span></div>
<div class="line">    <a class="code hl_function" href="../../d1/dea/esp__lcd_8c.html#ab19f1b5ac801f10a4913596be6cff3e7">lcdDefault</a>(&amp;lcd);</div>
<div class="line">    <span class="comment">/* Initialize LCD object */</span></div>
<div class="line">    <a class="code hl_function" href="../../d1/dea/esp__lcd_8c.html#a61e3da26c347bf106ecff196d14f971c">lcdInit</a>(&amp;lcd);</div>
<div class="line">    <span class="comment">/* Clear previous data on LCD */</span></div>
<div class="line">    <a class="code hl_function" href="../../d1/dea/esp__lcd_8c.html#aabda8e6338496228eac57ac7216f652f">lcdClear</a>(&amp;lcd);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        <span class="comment">/* Display Text */</span></div>
<div class="line">        <a class="code hl_function" href="../../d1/dea/esp__lcd_8c.html#a34a8ff5dcc5349b3b265d21ad82b8f10">lcdSetText</a>(&amp;lcd, <span class="stringliteral">&quot;Hello World!&quot;</span>, 0, 0);</div>
<div class="line">        <span class="comment">/* 1 second delay */</span></div>
<div class="line">        vTaskDelay(1000 / portTICK_PERIOD_MS);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    <span class="comment">/* Create LCD Task */</span></div>
<div class="line">    xTaskCreate(<a class="code hl_function" href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#a8d74856407edcce26b3d62d33a38c630">lcd_task</a>, <span class="stringliteral">&quot;LCD Task&quot;</span>, 2048, NULL, 4, NULL);</div>
<div class="line">}</div>
<div class="ttc" id="a_additional___labs_2_lab__10_2main_8c_html_abce06be17fc37d675118a678a8100a36"><div class="ttname"><a href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a></div><div class="ttdeci">void app_main()</div><div class="ttdef"><b>Definition</b> main.c:316</div></div>
<div class="ttc" id="a_additional___labs_2_lab__14_2main_8c_html_a8d74856407edcce26b3d62d33a38c630"><div class="ttname"><a href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#a8d74856407edcce26b3d62d33a38c630">lcd_task</a></div><div class="ttdeci">void lcd_task(void *pvParameters)</div><div class="ttdef"><b>Definition</b> main.c:16</div></div>
<div class="ttc" id="aesp__lcd_8c_html_a34a8ff5dcc5349b3b265d21ad82b8f10"><div class="ttname"><a href="../../d1/dea/esp__lcd_8c.html#a34a8ff5dcc5349b3b265d21ad82b8f10">lcdSetText</a></div><div class="ttdeci">lcd_err_t lcdSetText(lcd_t *const lcd, char *text, int x, int y)</div><div class="ttdoc">Set text.</div><div class="ttdef"><b>Definition</b> esp_lcd.c:240</div></div>
<div class="ttc" id="aesp__lcd_8c_html_a61e3da26c347bf106ecff196d14f971c"><div class="ttname"><a href="../../d1/dea/esp__lcd_8c.html#a61e3da26c347bf106ecff196d14f971c">lcdInit</a></div><div class="ttdeci">void lcdInit(lcd_t *const lcd)</div><div class="ttdoc">Initialize LCD object.</div><div class="ttdef"><b>Definition</b> esp_lcd.c:105</div></div>
<div class="ttc" id="aesp__lcd_8c_html_aabda8e6338496228eac57ac7216f652f"><div class="ttname"><a href="../../d1/dea/esp__lcd_8c.html#aabda8e6338496228eac57ac7216f652f">lcdClear</a></div><div class="ttdeci">lcd_err_t lcdClear(lcd_t *const lcd)</div><div class="ttdoc">Clear LCD screen Detailed description starts here.</div><div class="ttdef"><b>Definition</b> esp_lcd.c:306</div></div>
<div class="ttc" id="aesp__lcd_8c_html_ab19f1b5ac801f10a4913596be6cff3e7"><div class="ttname"><a href="../../d1/dea/esp__lcd_8c.html#ab19f1b5ac801f10a4913596be6cff3e7">lcdDefault</a></div><div class="ttdeci">void lcdDefault(lcd_t *const lcd)</div><div class="ttdoc">LCD default constructor.</div><div class="ttdef"><b>Definition</b> esp_lcd.c:154</div></div>
<div class="ttc" id="astructlcd__t_html"><div class="ttname"><a href="../../df/db0/structlcd__t.html">lcd_t</a></div><div class="ttdoc">LCD object.</div><div class="ttdef"><b>Definition</b> esp_lcd.h:48</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md147"></a>
Lab Template</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;driver/esp_lcd.h&quot;</span></div>
<div class="line"><span class="comment">/* Create Function to covert ADC Value to Voltage */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Create Function for ADC initialization */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#ac350db5dd3b5e4e2be490eb5f61538d2">ADC_setup</a>(<span class="keywordtype">void</span>){</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"><span class="comment">/* Create Function for PWM Initialization */</span></div>
<div class="line"><span class="keywordtype">void</span> PWM_setup(<span class="keywordtype">void</span>){</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"><span class="comment">/* Function for sweeper */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#a7c0dcc5e320f3de8829e900c8ced38ca">sweeper_function</a>(uint32_t val){</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"><span class="comment">/* LCD task */</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#a8d74856407edcce26b3d62d33a38c630">lcd_task</a>(<span class="keywordtype">void</span> *pvParameters){</div>
<div class="line">    <span class="comment">/* Setup LCD */</span></div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        <span class="comment">/* Get ADC Raw Readings */</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Get Conversion */</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Display Voltage onto LCD */</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Change PWM output to match ADC readings */</span></div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    <span class="comment">/* Create LCD Task */</span></div>
<div class="line">    </div>
<div class="line">}</div>
<div class="ttc" id="a_additional___labs_2_lab__14_2main_8c_html_a7c0dcc5e320f3de8829e900c8ced38ca"><div class="ttname"><a href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#a7c0dcc5e320f3de8829e900c8ced38ca">sweeper_function</a></div><div class="ttdeci">void sweeper_function(uint32_t val)</div><div class="ttdef"><b>Definition</b> main.c:12</div></div>
<div class="ttc" id="a_additional___labs_2_lab__14_2main_8c_html_ac350db5dd3b5e4e2be490eb5f61538d2"><div class="ttname"><a href="../../de/d2a/_additional___labs_2_lab__14_2main_8c.html#ac350db5dd3b5e4e2be490eb5f61538d2">ADC_setup</a></div><div class="ttdeci">void ADC_setup(void)</div><div class="ttdef"><b>Definition</b> main.c:8</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md148"></a>
Warning</h2>
<p>Before anything you must add the library for the LCD driver onto the <code>CMakeLists.txt</code> which is found in the lab's main folder. This would be how to add it: </p><div class="fragment"><div class="line">idf_component_register(SRCS <span class="stringliteral">&quot;main.c&quot;</span></div>
<div class="line">                            <span class="stringliteral">&quot;driver/esp_lcd.c&quot;</span></div>
<div class="line">                    INCLUDE_DIRS <span class="stringliteral">&quot;.&quot;</span>)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md149"></a>
Author:</h2>
<ul>
<li><a href="https://github.com/JorgeMinjares"><b>Jorge Minjares</b></a><br  />
<ul>
<li>Bachelor of Science in Electrical Engineering<br  />
 <a href="#" onclick="location.href='mai'+'lto:'+'jmi'+'nj'+'are'+'s5'+'@mi'+'ne'+'rs.'+'ut'+'ep.'+'ed'+'u'; return false;"><img src="https://img.shields.io/badge/Microsoft_Outlook-0078D4?style=for-the-badge&amp;logo=microsoft-outlook&amp;logoColor=white&amp;style=flat" alt="Outlook" class="inline"/></a> <a href="https://www.linkedin.com/in/jorge-minjares/"><img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&amp;logo=linkedin&amp;logoColor=white&amp;style=flat" alt="LinkedIn" class="inline"/></a> <a href="https://github.com/JorgeMinjares"><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&amp;logo=github&amp;logoColor=white&amp;style=flat" alt="GitHub" class="inline"/></a> </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <li class="footer"><a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template"><img class="footer" src="../../university_of_texas_at_el_paso_logo.png" width="104" height="31" alt="doxygen"/></a> v2.0 </li>
    </ul>
  </div>
  </body>
  </html>
  