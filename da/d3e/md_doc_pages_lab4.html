<!-- HTML header for doxygen 1.9.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Microprocessor 2 Labs: Lab 4 FreeRTOS: Semaphores</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../microprocessor_2_template.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../university_of_texas_at_el_paso_logo-2.png"/></td>
  <td id="projectalign">
   <div id="projectname">Microprocessor 2 Labs<span id="projectnumber">&#160;v2.0</span>
   </div>
   <div id="projectbrief">Microprocessor 2 Lab Documenation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<head>
  <html> 
  <head>
      <!-- ... other metadata & script includes ... -->
      <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
      <script type="text/javascript">
          DoxygenAwesomeDarkModeToggle.init()
      </script>
  </head>
  <body>
<html>
  <head>
      <!-- ... other metadata & script includes ... -->
      <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
      <script type="text/javascript">
          DoxygenAwesomeFragmentCopyButton.init()
      </script>
  </head>
  <body>
<html>
    <head>
      <a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template" class="github-corner" title="View source on GitHub" target="_blank">
        <svg viewBox="0 0 250 250" width="50" height="50" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    </head>
    <body>
  <!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('da/d3e/md_doc_pages_lab4.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Lab 4 FreeRTOS: Semaphores </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md54"></a>
Objective:</h1>
<ul>
<li>Understand how to use the semaphore with <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/freertos.html"><code>FreeRTOS</code></a>. In this lab, the main focus will be using semaphores to sycnrhonize various tasks.</li>
<li>Student must create four different tasks. Make task one run every two seconds. Task two should run twice as fast as task one. Task three should run every time either task one or task two run. And task four should run every time Task 3 runs.</li>
<li>Print “Task X running”for every task in the console.</li>
<li><b>Tasks</b><ul>
<li>Task 1 -&gt; run every two seconds</li>
<li>Task 2 -&gt; should run twice as fast as task one</li>
<li>Task 3 -&gt; run every time either task one or task two run</li>
<li>Task 4 -&gt; run every time Task 3 runs</li>
</ul>
</li>
<li><em><b>Undergrad Bonus:</b></em><ul>
<li>Turn an led every time <code>Task 3</code> or <code>Task 4</code> runs.</li>
</ul>
</li>
<li><em><b>Grad Bonus:</b></em><ul>
<li>Create an other two task indepenent from the other tasks: <code>Task 5</code> and <code>Task 6</code>. <code>Task 5</code> will sent a semaphore to <code>Task 6</code> which will turn the <code>onboard led</code> else turn off the led.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md55"></a>
ESP32 Pinout</h2>
<div class="fragment"><div class="line">                                        +-----------------------+</div>
<div class="line">                                        | O      | USB |      O |</div>
<div class="line">                                        |        -------        |</div>
<div class="line">                                    3V3 | [ ]               [ ] | VIN</div>
<div class="line">                                    GND | [ ]               [ ] | GND</div>
<div class="line">    Touch3 / HSPI_CS0 / ADC2_3 / GPIO15 | [ ]               [ ] | GPIO13 / ADC2_4 / HSPI_ID / Touch4</div>
<div class="line">CS / Touch2 / HSPI_WP / ADC2_2 /  GPIO2 | [ ]               [ ] | GPIO12 / ADC2_5 / HSPI_Q / Touch5</div>
<div class="line">     Touch0 / HSPI_HD / ADC2_0 /  GPIO4 | [ ]               [ ] | GPIO14 / ADC2_6 / HSPI_CLK / Touch6</div>
<div class="line">                        U2_RXD / GPIO16 | [ ]               [ ] | GPIO27 / ADC2_7 / Touch7</div>
<div class="line">                        U2_TXD / GPIO17 | [ ]               [ ] | GPIO26 / ADC2_9 / DAC2</div>
<div class="line">                     V_SPI_CS0 /  GPIO5 | [ ]  ___________  [ ] | GPIO25 / ADC2_8 / DAC1</div>
<div class="line">               SCK / V_SPI_CLK / GPIO18 | [ ] |           | [ ] | GPIO33 / ADC1_5 / Touch8 / XTAL32</div>
<div class="line">       U0_CTS / MSIO / V_SPI_Q / GPIO19 | [ ] |           | [ ] | GPIO32 / ADC1_4 / Touch9 / XTAL32</div>
<div class="line">                SDA / V_SPI_HD / GPIO21 | [ ] |           | [ ] | GPIO35 / ADC1_7 </div>
<div class="line">                 CLK2 / U0_RXD /  GPIO3 | [ ] |           | [ ] | GPIO34 / ADC1_6 </div>
<div class="line">                 CLK3 / U0_TXD /  GPIO1 | [ ] |           | [ ] | GPIO39 / ADC1_3 / SensVN </div>
<div class="line">       SCL / U0_RTS / V_SPI_WP / GPIO22 | [ ] |           | [ ] | GPIO36 / ADC1_0 / SensVP </div>
<div class="line">               MOSI / V_SPI_WP / GPIO23 | [ ] |___________| [ ] | EN </div>
<div class="line">                                        |                       |</div>
<div class="line">                                        |  |  |  ____  ____  |  |</div>
<div class="line">                                        |  |  |  |  |  |  |  |  |</div>
<div class="line">                                        |  |__|__|  |__|  |__|  |</div>
<div class="line">                                        | O                   O |</div>
<div class="line">                                        +-----------------------+</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md56"></a>
Example 1</h2>
<p >The following example is a brief demostration of how to use semaphore. <code>Task 1</code> will run every 2 second and give a sempahore for <code>Task 2</code> to run. <code>Task 2</code> will consistently wait to receive the sempahore which <code>Task 1</code> will provide every 2 seconds. Once task 2 recieve the semaphore from task 1 it will run and print <code>"Task 2 is running!!"</code>. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/semphr.h&quot;</span></div>
<div class="line"> </div>
<div class="line">SemaphoreHandle_t mySemaphore = NULL; <span class="comment">//create a global instance of an semaphore</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> exampleTask1(<span class="keywordtype">void</span> *pvParameter){</div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        xSemaphoreGive(mySemaphore); <span class="comment">//give semaphore to run task 2</span></div>
<div class="line">        vTaskDelay(2000 / portTICK_RATE_MS); <span class="comment">// 2 second delay</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Task 1 running!\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> exmapleTask2(<span class="keywordtype">void</span> *pvParameter){</div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">         <span class="comment">//wait for atleast 1 second</span></div>
<div class="line">         <span class="keywordflow">if</span>(xSemaphoreTake(mySemaphore, 1000/portTICK_RATE_MS) == pdTRUE){ </div>
<div class="line">             printf(<span class="stringliteral">&quot;Task 2 is running!!\n&quot;</span>);</div>
<div class="line">             vTaskDelay(100/portTICK_RATE_MS); <span class="comment">// 100 ms </span></div>
<div class="line">         }<span class="keywordflow">else</span>{</div>
<div class="line">             vTaskDelay(100/portTICK_RATE_MS); <span class="comment">// 100 ms delay</span></div>
<div class="line">         }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    mySemaphore = xSemaphoreCreateBinary(); <span class="comment">//create semaphore</span></div>
<div class="line">    xTaskCreate(&amp;exampleTask1, <span class="stringliteral">&quot;example task 1&quot;</span>, 2048, NULL, 4, NULL); <span class="comment">//create task</span></div>
<div class="line">    xTaskCreate(&amp;exampleTask2, <span class="stringliteral">&quot;example task 2&quot;</span>, 2048, NULL, 4, NULL); <span class="comment">//create task</span></div>
<div class="line">}</div>
<div class="ttc" id="a_additional___labs_2_lab__10_2main_8c_html_abce06be17fc37d675118a678a8100a36"><div class="ttname"><a href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a></div><div class="ttdeci">void app_main()</div><div class="ttdef"><b>Definition:</b> main.c:316</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md57"></a>
Example 2</h2>
<p >The following example is a more advance demostration of how to use semaphore. <code>Task 1</code> will wait for <code>mySemaphore1</code> and it recieves it; it will give <code>mySeamphore2</code>. <code>Task 2</code> will recieve the semaphore from <code>Task 1</code> and run. Once <code>Task 2</code> task is done, <code>mySemaphore1</code> will be give back for <code>Task 1</code> to run again. In simple terms, task 1 will run task 2 and task 2 will run task 1. Therefore, task 1 and task 2 synchronize which demostrate the true purpose of semaphores. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/semphr.h&quot;</span></div>
<div class="line"> </div>
<div class="line">SemaphoreHandle_t mySemaphore1 = NULL; <span class="comment">//create a global instance of an semaphore</span></div>
<div class="line">SemaphoreHandle_t mySemaphore2 = NULL; <span class="comment">//create a global instance of an semaphore</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> exampleTask1(<span class="keywordtype">void</span> *pvParameter){</div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        <span class="keywordflow">if</span>(xSemaphoreTake(mySemaphore1, (TickType_t)100 ) == pdTRUE){ <span class="comment">//TickType_t typecast</span></div>
<div class="line">              printf(<span class="stringliteral">&quot;Task 1 sent flag to task 2!\n&quot;</span>);</div>
<div class="line">              vTaskDelay(2000 / portTICK_RATE_MS); <span class="comment">// 2 second delay</span></div>
<div class="line">              xSemaphoreGive(mySemaphore2`); <span class="comment">//give semaphore to run task 2</span></div>
<div class="line">        }<span class="keywordflow">else</span>{</div>
<div class="line">              vTaskDelay(100 / portTICK_RATE_MS); <span class="comment">// 100 ms delay</span></div>
<div class="line">        }</div>
<div class="line">       </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> exmapleTask2(<span class="keywordtype">void</span> *pvParameter){</div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">         <span class="comment">//wait for atleast 100 second</span></div>
<div class="line">         <span class="keywordflow">if</span>(xSemaphoreTake(mySemaphore2, 100/portTICK_RATE_MS) == pdTRUE){ </div>
<div class="line">             printf(<span class="stringliteral">&quot;Task 2 is running!!!!\n&quot;</span>);</div>
<div class="line">             vTaskDelay(100/portTICK_RATE_MS); <span class="comment">// 100 ms </span></div>
<div class="line">             xSemaphoreGive(mySemaphore1); <span class="comment">//give back semaphore to task 1</span></div>
<div class="line">         }<span class="keywordflow">else</span>{</div>
<div class="line">             vTaskDelay(100/portTICK_RATE_MS); <span class="comment">// 100 ms delay</span></div>
<div class="line">         }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    <span class="comment">//Create two semaphores</span></div>
<div class="line">    mySemaphore1 = xSemaphoreCreateBinary(); <span class="comment">//create semaphore</span></div>
<div class="line">    mySemaphore2 = xSemaphoreCreateBinary(); <span class="comment">//create semaphore</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//Create two task </span></div>
<div class="line">    xTaskCreate(&amp;exampleTask1, <span class="stringliteral">&quot;example task 1&quot;</span>, 2048, NULL, 4, NULL); <span class="comment">//create task</span></div>
<div class="line">    xTaskCreate(&amp;exampleTask2, <span class="stringliteral">&quot;example task 2&quot;</span>, 2048, NULL, 4, NULL); <span class="comment">//create task</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// give the semaphore for task 1 to run</span></div>
<div class="line">    xSemaphoreGive(mySemaphore1); </div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md58"></a>
Template Code</h2>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">    Author:     Jesus Minjares and Erick Baca</span></div>
<div class="line"><span class="comment">                Master of Science in Computer Engineering</span></div>
<div class="line"><span class="comment">    Course:     EE 5190 Laboratory for Microprocessors Systems II   </span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    Lab 4:</span></div>
<div class="line"><span class="comment">            Understand how to use the semaphore with FreeRTOS. In this lab,</span></div>
<div class="line"><span class="comment">            the main focus will be using semaphores to sycnrhonize various tasks. </span></div>
<div class="line"><span class="comment">                </span></div>
<div class="line"><span class="comment">            * Student must create four different tasks. Make task one run every two seconds. Task two should run twice as fast as task one. Task three should run every time either task one or task two run. And task four should run every time Task 3 runs.</span></div>
<div class="line"><span class="comment">            * Print “Task X running”for every task in the console.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">            Tasks</span></div>
<div class="line"><span class="comment">                * Task 1 -&gt; run every two seconds</span></div>
<div class="line"><span class="comment">                * Task 2 -&gt; should run twice as fast as task one</span></div>
<div class="line"><span class="comment">                * Task 3 -&gt; run every time either task one or task two run</span></div>
<div class="line"><span class="comment">                * Task 4 -&gt; run every time Task 3 runs</span></div>
<div class="line"><span class="comment">  </span></div>
<div class="line"><span class="comment">            Bonus </span></div>
<div class="line"><span class="comment">            - Undergrad Bonus:</span></div>
<div class="line"><span class="comment">                * Turn an led every time `Task 3` or `Task 4` runs.</span></div>
<div class="line"><span class="comment">            - Grad Bonus:</span></div>
<div class="line"><span class="comment">                * Create an other two task indepenent from the other tasks: `Task 5` and `Task 6`. </span></div>
<div class="line"><span class="comment">                * `Task 5` will sent a semaphore to `Task 6` which will turn the `onboard led` else turn off the led. </span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/semphr.h&quot;</span></div>
<div class="line">SemaphoreHandle_t <a class="code hl_variable" href="../../df/d70/_lab__4_2main_8c.html#a0639b448c4862618f597670523ef9975">xSemaphore</a> = NULL;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>(<span class="keywordtype">void</span> *pvParameter)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">while</span> (1)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Task 1\n&quot;</span>);</div>
<div class="line">        vTaskDelay(1000 / portTICK_PERIOD_MS);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a8873379ac3ff18bce730e90e44aaf384">task2</a>(<span class="keywordtype">void</span> *pvParameter)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">while</span> (1)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Task 2\n&quot;</span>);</div>
<div class="line">        vTaskDelay(2000 / portTICK_PERIOD_MS);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>()</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_variable" href="../../df/d70/_lab__4_2main_8c.html#a0639b448c4862618f597670523ef9975">xSemaphore</a> = xSemaphoreCreateBinary();</div>
<div class="line">    xTaskCreate(&amp;<a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>, <span class="stringliteral">&quot;task1&quot;</span>, 4096, NULL, 5, NULL);</div>
<div class="line">    xTaskCreate(&amp;<a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a8873379ac3ff18bce730e90e44aaf384">task2</a>, <span class="stringliteral">&quot;task2&quot;</span>, 4096, NULL, 5, NULL);</div>
<div class="line">    xTaskCreate(&amp;task3, <span class="stringliteral">&quot;task3&quot;</span>, 4096, NULL, 6, NULL);</div>
<div class="line">    xTaskCreate(&amp;task4, <span class="stringliteral">&quot;task4&quot;</span>, 4096, NULL, 7, NULL);</div>
<div class="line">}</div>
<div class="ttc" id="a_lab__4_2main_8c_html_a0639b448c4862618f597670523ef9975"><div class="ttname"><a href="../../df/d70/_lab__4_2main_8c.html#a0639b448c4862618f597670523ef9975">xSemaphore</a></div><div class="ttdeci">SemaphoreHandle_t xSemaphore</div><div class="ttdef"><b>Definition:</b> main.c:61</div></div>
<div class="ttc" id="a_lab__4_2main_8c_html_a39542ccd929d82b3d70434fc6c03cde9"><div class="ttname"><a href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a></div><div class="ttdeci">void task1(void *pvParameter)</div><div class="ttdef"><b>Definition:</b> main.c:63</div></div>
<div class="ttc" id="a_lab__4_2main_8c_html_a8873379ac3ff18bce730e90e44aaf384"><div class="ttname"><a href="../../df/d70/_lab__4_2main_8c.html#a8873379ac3ff18bce730e90e44aaf384">task2</a></div><div class="ttdeci">void task2(void *pvParameter)</div><div class="ttdef"><b>Definition:</b> main.c:71</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md59"></a>
C helpful functions</h1>
<p >For this lab, there are few important function calls that are going to be used throughout the lab. Semaphores are created by using <code>SemaphoreHandle_t</code> data type. For instance, <b><code>SemaphoreHandle_t</code></b> <em>mySemaphore</em> is how you would create a semaphore.</p>
<p >To be able to allocate an instance of an semaphore, you will need the following function: <code>xSemaphoreCreateBinary</code>. There are different types of semaphores, however we will only look at the binary semahpore. A binary semaphore as the name states it can have a value either <code>0</code> or <code>1</code>. </p><div class="fragment"><div class="line">SemaphoreHandle_t xSemaphoreCreateBinary( <span class="keywordtype">void</span> );</div>
</div><!-- fragment --><p> Next, <code>xSemahporeGive</code> will set a <code>0</code> in the semaphore. Therefore, by setting a <code>0</code> it will state that the semaphore is ready to be used. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> xSemaphoreGive( SemaphoreHandle_t <a class="code hl_variable" href="../../df/d70/_lab__4_2main_8c.html#a0639b448c4862618f597670523ef9975">xSemaphore</a> );</div>
</div><!-- fragment --><p> Lastly, <code>xSemaphoreTake</code> is the opposite of the prior function. Therefore, it will set a <code>1</code> meaning that the semahpore is being use. However, <code>xSemaphoreTake</code> will require two parameters <code>SemaphoreHandle_t xSemaphore</code> and <code>TickType_t xTicksToWait</code>. You must pass by value the instance of a semaphore and also how long are you planning to wait for the semaphore. If you receive the semaphore during the time frame <code>xSemaphoreTake</code> will return <code>pdTRUE</code> else <code>pdFALSE</code>. </p><div class="fragment"><div class="line">xSemaphoreTake( SemaphoreHandle_t <a class="code hl_variable" href="../../df/d70/_lab__4_2main_8c.html#a0639b448c4862618f597670523ef9975">xSemaphore</a>, TickType_t xTicksToWait );</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md60"></a>
Additional Links</h2>
<ul>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/freertos.html">FreeRTOS Semphores</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/freertos.html">FreeRTOS Espressif Documenation</a></li>
<li><a href="https://www.freertos.org/a00125.html">FreeRTOS Documenation</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md61"></a>
Authors</h2>
<ul>
<li><a href="https://github.com/jminjares4"><em><b>Jesus Minjares</b></em></a><ul>
<li><b>Master of Science in Computer Engineering</b> <br  />
 <a href="https://www.linkedin.com/in/jesusminjares/"><img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&amp;logo=linkedin&amp;logoColor=white&amp;style=flat" alt="LinkedIn" class="inline"/></a> <a href="https://github.com/jminjares4"><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&amp;logo=github&amp;logoColor=white&amp;style=flat" alt="GitHub" class="inline"/></a></li>
</ul>
</li>
<li><a href="https://github.com/eabaca2419"><em><b>Erick Baca</b></em></a><ul>
<li><b>Master of Science in Computer Engineering</b> <br  />
 <a href="https://www.linkedin.com/in/erick-baca-484bbb215/"><img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&amp;logo=linkedin&amp;logoColor=white&amp;style=flat" alt="LinkedIn" class="inline"/></a> <a href="https://github.com/eabaca2419"><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&amp;logo=github&amp;logoColor=white&amp;style=flat" alt="GitHub" class="inline"/></a></li>
</ul>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template/tree/main/Lab_4">GitHub Lab 4</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <li class="footer"><a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template"><img class="footer" src="../../university_of_texas_at_el_paso_logo.png" width="104" height="31" alt="doxygen"/></a> v2.0 </li>
    </ul>
  </div>
  </body>
  </html>
  