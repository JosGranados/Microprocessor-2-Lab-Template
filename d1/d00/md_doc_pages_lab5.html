<!-- HTML header for doxygen 1.9.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Microprocessor 2 Labs: Lab 5 FreeRTOS: Queue</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../microprocessor_2_template.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../university_of_texas_at_el_paso_logo-2.png"/></td>
  <td id="projectalign">
   <div id="projectname">Microprocessor 2 Labs<span id="projectnumber">&#160;v2.0</span>
   </div>
   <div id="projectbrief">Microprocessor 2 Lab Documenation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<head>
  <html> 
  <head>
      <!-- ... other metadata & script includes ... -->
      <script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
      <script type="text/javascript">
          DoxygenAwesomeDarkModeToggle.init()
      </script>
  </head>
  <body>
<html>
  <head>
      <!-- ... other metadata & script includes ... -->
      <script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
      <script type="text/javascript">
          DoxygenAwesomeFragmentCopyButton.init()
      </script>
  </head>
  <body>
<html>
    <head>
      <a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template" class="github-corner" title="View source on GitHub" target="_blank">
        <svg viewBox="0 0 250 250" width="50" height="50" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    </head>
    <body>
  <!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d1/d00/md_doc_pages_lab5.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Lab 5 FreeRTOS: Queue </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md57"></a>
Objective:</h1>
<ul>
<li>Understand how to use the queues with <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/freertos.html#queue-api"><code>FreeRTOS</code></a>. In this lab, the main focus will be using queues to send data among tasks.</li>
<li>Create a program which will create a queue to send and receive data.</li>
<li>Send data to the queue from multiple tasks, sending integers <code>10</code> and <code>20</code> also for strings <code>“EE4178”</code> and <code>“Fall2021”</code>.</li>
<li>Receive and print data from the queue</li>
</ul>
<h2><a class="anchor" id="autotoc_md58"></a>
Bonus</h2>
<ul>
<li><em><b>Undergrad Bonus:</b></em><ul>
<li>Modify the code by sending structures on a queue. <div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">char</span> str[10];</div>
<div class="line">    int32_t val;</div>
<div class="line">}<a class="code hl_struct" href="../../dd/d65/struct_undergaduate__t.html">Undergaduate_t</a>;</div>
<div class="ttc" id="astruct_undergaduate__t_html"><div class="ttname"><a href="../../dd/d65/struct_undergaduate__t.html">Undergaduate_t</a></div><div class="ttdef"><b>Definition:</b> main.c:57</div></div>
</div><!-- fragment --></li>
</ul>
</li>
<li><em><b>Grad Bonus:</b></em><ul>
<li>Modify the code by sending structures on a queue. If <code>isLedOn</code> <em>true</em>, turn the <code>LED</code> else, turn off. <div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">char</span> str[10];</div>
<div class="line">    int32_t val;</div>
<div class="line">    <span class="keywordtype">char</span> studentName[15];</div>
<div class="line">    uint32_t studentID;</div>
<div class="line">    <span class="keywordtype">bool</span> isLedOn;</div>
<div class="line">}<a class="code hl_struct" href="../../d5/de6/struct_graduate__t.html">Graduate_t</a>;</div>
<div class="ttc" id="astruct_graduate__t_html"><div class="ttname"><a href="../../d5/de6/struct_graduate__t.html">Graduate_t</a></div><div class="ttdef"><b>Definition:</b> main.c:63</div></div>
</div><!-- fragment --></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md59"></a>
ESP32 Pinout</h2>
<div class="fragment"><div class="line">                                        +-----------------------+</div>
<div class="line">                                        | O      | USB |      O |</div>
<div class="line">                                        |        -------        |</div>
<div class="line">                                    3V3 | [ ]               [ ] | VIN</div>
<div class="line">                                    GND | [ ]               [ ] | GND</div>
<div class="line">    Touch3 / HSPI_CS0 / ADC2_3 / GPIO15 | [ ]               [ ] | GPIO13 / ADC2_4 / HSPI_ID / Touch4</div>
<div class="line">CS / Touch2 / HSPI_WP / ADC2_2 /  GPIO2 | [ ]               [ ] | GPIO12 / ADC2_5 / HSPI_Q / Touch5</div>
<div class="line">     Touch0 / HSPI_HD / ADC2_0 /  GPIO4 | [ ]               [ ] | GPIO14 / ADC2_6 / HSPI_CLK / Touch6</div>
<div class="line">                        U2_RXD / GPIO16 | [ ]               [ ] | GPIO27 / ADC2_7 / Touch7</div>
<div class="line">                        U2_TXD / GPIO17 | [ ]               [ ] | GPIO26 / ADC2_9 / DAC2</div>
<div class="line">                     V_SPI_CS0 /  GPIO5 | [ ]  ___________  [ ] | GPIO25 / ADC2_8 / DAC1</div>
<div class="line">               SCK / V_SPI_CLK / GPIO18 | [ ] |           | [ ] | GPIO33 / ADC1_5 / Touch8 / XTAL32</div>
<div class="line">       U0_CTS / MSIO / V_SPI_Q / GPIO19 | [ ] |           | [ ] | GPIO32 / ADC1_4 / Touch9 / XTAL32</div>
<div class="line">                SDA / V_SPI_HD / GPIO21 | [ ] |           | [ ] | GPIO35 / ADC1_7 </div>
<div class="line">                 CLK2 / U0_RXD /  GPIO3 | [ ] |           | [ ] | GPIO34 / ADC1_6 </div>
<div class="line">                 CLK3 / U0_TXD /  GPIO1 | [ ] |           | [ ] | GPIO39 / ADC1_3 / SensVN </div>
<div class="line">       SCL / U0_RTS / V_SPI_WP / GPIO22 | [ ] |           | [ ] | GPIO36 / ADC1_0 / SensVP </div>
<div class="line">               MOSI / V_SPI_WP / GPIO23 | [ ] |___________| [ ] | EN </div>
<div class="line">                                        |                       |</div>
<div class="line">                                        |  |  |  ____  ____  |  |</div>
<div class="line">                                        |  |  |  |  |  |  |  |  |</div>
<div class="line">                                        |  |__|__|  |__|  |__|  |</div>
<div class="line">                                        | O                   O |</div>
<div class="line">                                        +-----------------------+</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md60"></a>
Example 1</h2>
<p >The following example is a quick demostration of how to use queues with FreeRTOS on the ESP32. First, a queue is create as a global variable to scope accessiblity name <code>myQueue</code>. Next, that variable must store an instance of a queue by <code>xQueueCreate</code> function. <code>Task 1</code> will send <code>data</code> which store a <code>10</code> to <code>Task 2</code> every second. <code>Task 2</code> will recieve data through the queue and display it in the terminal. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/queue.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Global Queue handle */</span></div>
<div class="line">QueueHandle_t myQueue;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> exampleTask1(<span class="keywordtype">void</span> *pvParameter){</div>
<div class="line">    <span class="keywordtype">int</span> data = 10;</div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        xQueueSendToBack(myQueue, &amp;data, 0);</div>
<div class="line">        vTaskDelay(1000/portTICK_RATE_MS);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> exampleTask2(<span class="keywordtype">void</span> *pvParameter){</div>
<div class="line">    <span class="keywordtype">int</span> storeData;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        <span class="keywordflow">if</span>(xQueueReceive(myQueue, &amp;storeData, (TickType_t)100) == pdPASS){</div>
<div class="line">            printf(<span class="stringliteral">&quot;Data receive from task 1: %d\n&quot;</span>, storeData); <span class="comment">// display data recieve</span></div>
<div class="line">            vTaskDelay(100/portTICK_RATE_MS); <span class="comment">// 100 ms </span></div>
<div class="line">        }</div>
<div class="line">        vTaskDelay(500/portTICK_RATE_MS); <span class="comment">// 500 ms </span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    myQueue = xQueueCreate(5, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line">    xTaskCreate(&amp;exmapleTask1, <span class="stringliteral">&quot;example task 1&quot;</span>, 2048, NULL, 4, NULL);</div>
<div class="line">    xTaskCreate(&amp;exampleTask2, <span class="stringliteral">&quot;example task 2), 2048, NULL, 4, NULL);</span></div>
<div class="line"><span class="stringliteral">}</span></div>
<div class="ttc" id="a_additional___labs_2_lab__10_2main_8c_html_abce06be17fc37d675118a678a8100a36"><div class="ttname"><a href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a></div><div class="ttdeci">void app_main()</div><div class="ttdef"><b>Definition:</b> main.c:316</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md61"></a>
Example 2</h2>
<p >The following example is an demostration of how to pass argument through a task. As mention in previous labs, <code>xTaskCreate</code> has the various parameters that we went briefly in detail. The 4th argument is the argument that is pass to the task. In the bottom code, <code>Task 1</code> is recieving the data store in <code>number</code> when it being created in main. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> number = 69; <span class="comment">// make it fun</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>(<span class="keywordtype">void</span> *pvParameters){</div>
<div class="line">    <span class="keywordtype">int</span> data = (int)pvParameters; <span class="comment">//type cast data</span></div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        printf(<span class="stringliteral">&quot;Data recieved: %d\n&quot;</span>,data); <span class="comment">//print message </span></div>
<div class="line">        vTaskDelay(2000/portTICK_RATE_MS); <span class="comment">// 2 second delay</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    xTaskCreate(&amp;<a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>, <span class="stringliteral">&quot;Task 1&quot;</span>, 2048, (<span class="keywordtype">void</span>*)number, 4, NULL);</div>
<div class="line">}</div>
<div class="ttc" id="a_lab__4_2main_8c_html_a39542ccd929d82b3d70434fc6c03cde9"><div class="ttname"><a href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a></div><div class="ttdeci">void task1(void *pvParameter)</div><div class="ttdef"><b>Definition:</b> main.c:63</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md62"></a>
Example 3</h2>
<p >The following code is similar to the previous example however the major difference is using <code>global</code> and <code>static</code> variables.<code>static</code> keyword states that the variable that we create will store its data in the static memory. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>(<span class="keywordtype">void</span> *pvParameters){</div>
<div class="line">    <span class="keywordtype">int</span> data = (int)pvParameters; <span class="comment">//type cast data</span></div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        printf(<span class="stringliteral">&quot;Data recieved: %d\n&quot;</span>,data); <span class="comment">//print message </span></div>
<div class="line">        vTaskDelay(2000/portTICK_RATE_MS); <span class="comment">// 2 second delay</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> number = 420; <span class="comment">// make it fun</span></div>
<div class="line">    xTaskCreate(&amp;<a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>, <span class="stringliteral">&quot;Task 1&quot;</span>, 2048, (<span class="keywordtype">void</span>*)number, 4, NULL);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md63"></a>
Template Code</h2>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">    Author:     Jesus Minjares and Erick Baca</span></div>
<div class="line"><span class="comment">                Master of Science in Computer Engineering</span></div>
<div class="line"><span class="comment">    Course:     EE 5190 Laboratory for Microprocessors Systems II</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    Lab 5:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">                Understand how to use the queues with FreeRTOS. In this lab,</span></div>
<div class="line"><span class="comment">                the main focus will be using queues to send data among tasks. </span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">                * Create a program which will create a queue to send and receive data.</span></div>
<div class="line"><span class="comment">                * Send data to the queue from multiple tasks, sending integers `10` and `20`</span></div>
<div class="line"><span class="comment">                  also  for strings `“EE4178”` and `“Fall2021”`.</span></div>
<div class="line"><span class="comment">                * Receive and print data from the queue</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">            Bonus</span></div>
<div class="line"><span class="comment">                - Undergrad Bonus:</span></div>
<div class="line"><span class="comment">                    * Modify the code by sending structures on a queue.</span></div>
<div class="line"><span class="comment">                - Grad Bonus:</span></div>
<div class="line"><span class="comment">                    * Modify the code by sending structures on a queue.</span></div>
<div class="line"><span class="comment">                      If `isLedOn` *true*, turn the `LED` else, turn off.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdkconfig.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/FreeRTOS.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/task.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;freertos/queue.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Undergraduate Bonus */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">char</span> str[10];</div>
<div class="line">    int32_t val;</div>
<div class="line">}<a class="code hl_struct" href="../../dd/d65/struct_undergaduate__t.html">Undergaduate_t</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Graduate Bonus */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">char</span> str[10];</div>
<div class="line">    int32_t val;</div>
<div class="line">    <span class="keywordtype">char</span> studentName[15];</div>
<div class="line">    uint32_t studentID;</div>
<div class="line">    <span class="keywordtype">bool</span> isLedOn;</div>
<div class="line">}<a class="code hl_struct" href="../../d5/de6/struct_graduate__t.html">Graduate_t</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Global Queue handle */</span></div>
<div class="line">QueueHandle_t <a class="code hl_variable" href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>(<span class="keywordtype">void</span> *pvParameters){</div>
<div class="line">    int32_t data = (int32_t)pvParameters; <span class="comment">//store data pass by argument</span></div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        xQueueSendToBack(<a class="code hl_variable" href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a>, &amp;data, 0); <span class="comment">//send data to the queue</span></div>
<div class="line">        vTaskDelay(1000/portTICK_RATE_MS); <span class="comment">// 1 second delay</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a8873379ac3ff18bce730e90e44aaf384">task2</a>(<span class="keywordtype">void</span> *pvParameters){</div>
<div class="line">    int32_t dataReceive;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">        <span class="keywordflow">if</span>(xQueueReceive(<a class="code hl_variable" href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a>, &amp;dataReceive, (TickType_t)1000) == pdPASS){</div>
<div class="line">            printf(<span class="stringliteral">&quot;Data received: %d\n&quot;</span>, dataReceive); <span class="comment">//print data received </span></div>
<div class="line">            vTaskDelay(100 / portTick_RATE_MS);  <span class="comment">//100 ms</span></div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// if you do not want to use static, comment the ones in main and uncomment these ones</span></div>
<div class="line"><span class="comment">// int32_t data1 = 10;</span></div>
<div class="line"><span class="comment">// int32_t data2 = 20;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../dd/d74/_additional___labs_2_lab__10_2main_8c.html#abce06be17fc37d675118a678a8100a36">app_main</a>(<span class="keywordtype">void</span>){</div>
<div class="line">    <span class="comment">/*  Create static variable so they will be store in static memory</span></div>
<div class="line"><span class="comment">        and once the main terminate, it content will not be corrupted.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">        If you do not want to use static variables make the global!!! :)</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">    <span class="keyword">static</span> int32_t data1 = 10, data2 = 20;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create Queue of type int32_t */</span></div>
<div class="line">    <a class="code hl_variable" href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a> = xQueueCreate(5, <span class="keyword">sizeof</span>(int32_t));</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Check if the queue was create successfully */</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a> != NULL){</div>
<div class="line">        <span class="comment">/* Create sender tasks and send int32_t as arguments */</span></div>
<div class="line">        xTaskCreate(&amp;<a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>, <span class="stringliteral">&quot;Task 1a &quot;</span>, 2048, (<span class="keywordtype">void</span> *)data1, 1, NULL);</div>
<div class="line">        xTaskCreate(&amp;<a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a39542ccd929d82b3d70434fc6c03cde9">task1</a>, <span class="stringliteral">&quot;Task 1b&quot;</span>, 2048, (<span class="keywordtype">void</span> *)data2, 1, NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create reciever task */</span></div>
<div class="line">        xTaskCreate(&amp;<a class="code hl_function" href="../../df/d70/_lab__4_2main_8c.html#a8873379ac3ff18bce730e90e44aaf384">task2</a>,<span class="stringliteral">&quot;Task 2&quot;</span>, 2048, NULL, 2, NULL);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="a_lab__4_2main_8c_html_a8873379ac3ff18bce730e90e44aaf384"><div class="ttname"><a href="../../df/d70/_lab__4_2main_8c.html#a8873379ac3ff18bce730e90e44aaf384">task2</a></div><div class="ttdeci">void task2(void *pvParameter)</div><div class="ttdef"><b>Definition:</b> main.c:71</div></div>
<div class="ttc" id="a_lab__5_2main_8c_html_aa78b6121b7586233293fb6cba5e19206"><div class="ttname"><a href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a></div><div class="ttdeci">QueueHandle_t xQueue</div><div class="ttdef"><b>Definition:</b> main.c:72</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md64"></a>
C helpful functions</h1>
<p >For this lab, there are few important function calls that are going to be used throughout the lab. Queues are created by using <code>QueueHandle_t</code> data type. For instance, <b><code>QueueHandle_t</code></b> <em>myQueue</em> is how you would create a queue.</p>
<p >First, <code>xQueueCreate</code> is the function you must call if you want to create a queue. <code>xQueueCreate</code> has two parameters, <code>UBaseType_t</code> uxQueueLength, and <code>UBaseType_t</code> uxItemSize. Therefore, if we wanted to create a queue of <code>float</code>'s we would do the following: </p><div class="fragment"><div class="line">QueueHandle_t myQueue; <span class="comment">//global queue</span></div>
<div class="line">...</div>
<div class="line">myQueue = xQueueCreate(10, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)); <span class="comment">//create a queue of float with a max size of 5</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">QueueHandle_t xQueueCreate( UBaseType_t uxQueueLength, UBaseType_t uxItemSize );</div>
</div><!-- fragment --><p >Next, <code>xQueueSendToBack</code> and <code>xQueueSendToFront</code> are similar function with the slight differnet of where they send the data to the queue. As the name suggests, <code>xQueueSendToBack</code>, sends the data to the back of the queue. Both function have three parameters, <code>QueueHandle_t</code> xQueue, <code>const void *</code> pvItemToQueue, <code>TickType_t</code> xTicksToWait. Therefore, if want to send something through our queue we would set the queue in which the data will be sent, pass by reference the data, and how long we wait to the send the data. </p><div class="fragment"><div class="line">BaseType_t xQueueSendToBack(</div>
<div class="line">                                  QueueHandle_t <a class="code hl_variable" href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a>,</div>
<div class="line">                                  <span class="keyword">const</span> <span class="keywordtype">void</span> * pvItemToQueue,</div>
<div class="line">                                  TickType_t xTicksToWait</div>
<div class="line">                              );</div>
</div><!-- fragment --> <div class="fragment"><div class="line">BaseType_t xQueueSendToFront(</div>
<div class="line">                                  QueueHandle_t <a class="code hl_variable" href="../../da/de1/_lab__5_2main_8c.html#aa78b6121b7586233293fb6cba5e19206">xQueue</a>,</div>
<div class="line">                                  <span class="keyword">const</span> <span class="keywordtype">void</span> * pvItemToQueue,</div>
<div class="line">                                  TickType_t xTicksToWait</div>
<div class="line">                              );</div>
</div><!-- fragment --><p> Lastly, <code>xQueueReceive</code> is the opposite of <code>xQueueSendToBack</code> and <code>xQueueSendToFront</code> in the sense that it will store the data in <code>void * const</code> pvBuffer. </p><div class="fragment"><div class="line">BaseType_t xQueueReceive(QueueHandle_txQueue, <span class="keywordtype">void</span> *<span class="keyword">const</span> pvBuffer, TickType_t xTicksToWait)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md65"></a>
Additional Links</h2>
<ul>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/freertos.html#queue-api">FreeRTOS Queue</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/freertos.html">FreeRTOS Espressif Documenation</a></li>
<li><a href="https://www.freertos.org/a00125.html">FreeRTOS Documenation</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md66"></a>
Authors</h2>
<ul>
<li><a href="https://github.com/jminjares4"><em><b>Jesus Minjares</b></em></a><ul>
<li><b>Master of Science in Computer Engineering</b> <br  />
 <a href="https://www.linkedin.com/in/jesusminjares/"><img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&amp;logo=linkedin&amp;logoColor=white&amp;style=flat" alt="LinkedIn" class="inline"/></a> <a href="https://github.com/jminjares4"><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&amp;logo=github&amp;logoColor=white&amp;style=flat" alt="GitHub" class="inline"/></a></li>
</ul>
</li>
<li><a href="https://github.com/eabaca2419"><em><b>Erick Baca</b></em></a><ul>
<li><b>Master of Science in Computer Engineering</b> <br  />
 <a href="https://www.linkedin.com/in/erick-baca/"><img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&amp;logo=linkedin&amp;logoColor=white&amp;style=flat" alt="LinkedIn" class="inline"/></a> <a href="https://github.com/eabaca2419"><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&amp;logo=github&amp;logoColor=white&amp;style=flat" alt="GitHub" class="inline"/></a></li>
</ul>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template/tree/main/Lab_5">GitHub Lab 5</a></dd></dl>
<p><span class="next_section_button"> Read Next: <a class="el" href="../../d8/d2a/md_doc_pages_lab6.html">Lab 6</a> </span> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <li class="footer"><a href="https://github.com/jminjares4/Microprocessor-2-Lab-Template"><img class="footer" src="../../university_of_texas_at_el_paso_logo.png" width="104" height="31" alt="doxygen"/></a> v2.0 </li>
    </ul>
  </div>
  </body>
  </html>
  